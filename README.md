# Kuznechik-Encryption-Attack
<p>Моделирование атаки внесением ошибок на шифр ГОСТ 34.12–2018 «Кузнечик».</p>
<p>Для реализации атаки имеем следующие предположения:</p>
<li>Атакующий имеет доступ к регистрам устройства шифрования: он не знает их значения, но может обнулить состояние конкретного регистра в конкретный момент времени;
<li>Атакующий может неограниченное число раз подавать на вход шифрующему устройству различные открытые тексты и получать соответствующие зашифрованные сообщения;
<li>Устройство шифрования в своей реализации использует известные блоки перестановок, предложенные в стандарте;
<li>Внутри устройства шифрования хранится ключ K, который используется для шифрования, и атакующий стремится узнать значение K.
<p>Алгоритм следующий. Пусть P[i] - байт открытого текста, S<sup>-1</sup>(0) - обратная перестановка S от 0. Тогда для нахождения первой части (K<sub>1</sub>) мастер-ключа нужно:</p>
<li>Изменять соответствующий байт исходного сообщения;
<li>Вносить ошибку на 1-ом раунде шифрования после преобразования S - обнулить соответствующий регистр (байт);
<li>После шифрования сравнить тексты, зашифрованные без внесения ошибки и с ошибкой;
<li>Если тексты совпадают, значит внесение ошибки не повлияло на процесс шифрования. Тогда делается вывод, что в соответствующем байте действительно был 0;
<li>При помощи формулы K<sub>1</sub>[i] = P[i] ⊕ S<sup>-1</sup>(0) вычисляется i-ый байт первой части мастер-ключа;
<li>Вышеописанные действия повторяются до тех пор, пока не будет вычислен вся часть ключа K<sub>1</sub>.
<p>Вторая часть мастер-ключа (K<sub>2</sub>) вычисляется аналогично, но с некоторыми дополнениями:</p> 
<li>Из первого раунда получается первая часть ключа K<sub>1</sub>;
<li>Исходное сообщение и часть ключа K<sub>1</sub> проходят через один раунд шифрования (XSL) - получается входной текст для 2-го рануда;
<li>Далее идут аналогичные первому раунду действия, но ошибка вносится уже на втором раунде.
<p>В результате получаются две части ключа - K<sub>1</sub> и K<sub>2</sub>, которые объединятся конкатенацией и получается искомый мастер-ключ.</p>
